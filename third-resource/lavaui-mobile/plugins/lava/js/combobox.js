!function(e){var a={init:function(a){var t=this,o=e(a),l=o.data("combobox").options;o.combo({editable:l.editable,panelHeight:l.panelHeight});var n=o.data("combo").panel.addClass("list-group").css({overflow:"auto"});o.data("combobox").panel=n,l.url?t.remoteData(o,l,n):l.data&&t.loadData(o,l,n),t.initEvent(o,l,n)},loadData:function(e,a,t,o){for(var l=a.data,n=[],i=e.val(),u=0;u<l.length;u++)(!o||o(i,l[u]))&&n.push("<a href='javascript:;' class='list-group-item' data-value='"+l[u][a.valueField]+"'>"+l[u][a.textField]+"</a>");t.html(n.join("")),a.onLoadSuccess&&a.onLoadSuccess()},remoteData:function(a,t,o){var l=this;e.ajax({url:t.url,type:t.method,dataType:"json",data:t.formData,success:function(e){t.loadFilter&&(e=t.loadFilter(e)),t.data=e,l.loadData(a,t,o)}})},initEvent:function(a,t,o){var l=this;o.delegate(".list-group-item","click",function(){var n=e(this),i=n.attr("data-value");t.multiple?(n.hasClass("active")?(n.removeClass("active"),l.setValue(a,t,i,!1),t.onUnselect&&t.onUnselect(l.getItemByValue(t.data,i,t.valueField))):(n.addClass("active"),l.setValue(a,t,i,!0),t.onSelect&&t.onSelect(l.getItemByValue(t.data,i,t.valueField))),l.setInputValue(a,t.values,t.textField)):(n.hasClass("active")||(o.find(".active").removeClass("active"),n.addClass("active"),l.setValue(a,t,i),t.onSelect&&t.onSelect(l.getItemByValue(t.data,i,t.valueField))),o.hide())}),"local"==t.mode&&t.filter?a.on("keyup",function(){t.value=null,a.timer&&clearTimeout(a.timer),a.timer=setTimeout(function(){l.loadData(a,t,o,t.filter)},200)}):"remote"==t.mode&&t.loader&&a.on("keyup",function(){t.values={},a.timer&&clearTimeout(a.timer),a.timer=setTimeout(function(){t.loader({q:a.val()},function(e){t.data=e,l.loadData(a,t,o)},function(){console.log&&console.log("loader: load err.")})},200)})},setValue:function(e,a,t,o){var l=this,n=(a.data,a.values),i=l.getItemByValue(a.data,t,a.valueField);void 0==o?(a.value=t,e.val(i?i[a.textField]:"")):1==o?n[t]=i?i[a.textField]:"":delete n[t]},getItemByValue:function(e,a,t){for(var o=0;o<e.length;o++)if(e[o][t]==a)return e[o];return null},setInputValue:function(e,a){var t=[];for(var o in a)t.push(a[o]);e.val(t.join(","))},setValues:function(a,t){var o=e(a),l=o.data("combobox").options,n=this;l.values={};for(var i=0;i<t.length;i++){var u=n.getItemByValue(l.data,t[i],l.valueField);l.values[t[i]]=u?u[l.textField]:""}n.setInputValue(o,l.values,l.textField)}};e.fn.combobox=function(t,o){return"string"==typeof t?e.fn.combobox.methods[t](this,o):void e.each(this,function(){var o={};e.extend(o,e.fn.combo.defaults),e.extend(o,e.fn.combobox.defaults),e.extend(o,t),e(this).data("combobox",{options:o}),a.init(this)})},e.fn.combobox.defaults={url:null,method:"get",valueField:"id",textField:"text",multiple:!1,panelHeight:250,value:null,values:{},mode:"local",filter:null,formData:{},onSelect:null,onLoadSucces:null},e.fn.combobox.methods={getValue:function(a){return e(a).data("combobox").options.value},getValues:function(a){var t=e(a).data("combobox").options.values,o=[];for(var l in t)o.push(l);return o},setValue:function(t,o){var l=e(t),n=l.data("combobox").options;a.setValue(l,n,o),l.data("combobox").panel.find(".active").removeClass("active"),l.data("combobox").panel.find("[data-value="+o+"]").addClass("active")},setValues:function(t,o){var l=e(t);a.setValues(t,o),l.data("combobox").panel.find(".active").removeClass("active");for(var n in o)l.data("combobox").panel.find("[data-value="+o[n]+"]").addClass("active")},reload:function(t,o){var l=e(t);o&&(l.data("combobox").options.url=o),a.remoteData(l,l.data("combobox").options,l.data("combo").panel)}}}(jQuery);