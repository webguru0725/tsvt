var lavaCalendar={init:function(a){var t=this,e=$(a),n=e.data("calendar").options,l=$.fn.lavaCalendar.locales[n.lang];e.html(""),e.addClass("lava-calendar");for(var d=$("<div class='lava-calendar-header' style='background:"+n.color+";'></div>").appendTo(e),r=($("<div class='lava-calendar-prev'>«</div>").appendTo(d),$("<div class='lava-calendar-next'>»</div>").appendTo(d),$("<span></span>").appendTo(d),$("<table class='lava-calendar-table'></table>").appendTo(e)),o=$("<thead class='lava-calendar-thead'></thead>").appendTo(r),i=$("<tbody class='lava-calendar-tbody'></tbody>").appendTo(r),s=["<tr>"],c=0;7>c;c++)s.push("<th style='color:"+n.color+";'>"+l[c]+"</th>");s.push("</tr>");for(var v=[],c=0;6>c;c++){for(var h=["<tr>"],p=0;7>p;p++)h.push("<td></td>");h.push("</tr>"),v.push(h.join(""))}o.html(s.join("")),i.html(v.join("")),t.loadDate(a),t.resize(a)},loadDate:function(a){var t=this,e=$(a),n=e.data("calendar").options,l=n.currentDate;l.setDate(1);var d=n.currentDate.getFullYear(),r=n.currentDate.getMonth();e.find(".lava-calendar-header span").text(d+"-"+t.round(r+1));var o=e.find("td"),i=l.getDay(),s=new Date(l.getTime());s.setMonth(r+1),s.setTime(s.getTime()-864e5);var c=s.getDate();o.text("").removeAttr("data-date").removeAttr("class");for(var v=0;c>v;v++)o.eq(v+i).text(v+1).attr("data-date",d+"/"+(r+1)+"/"+(v+1));if(n.showOtherDate){for(var h=new Date(l.getTime()-864e5),p=h.getDate(),d=h.getFullYear(),r=h.getMonth(),v=0;i>v;v++){var _=p-i+v+1;o.eq(v).text(_).attr("data-date",d+"/"+(r+1)+"/"+_).addClass("other")}var u=new Date(l.getTime());u.setMonth(r+2);for(var d=u.getFullYear(),r=u.getMonth(),v=0;42-i-c>v;v++)o.eq(i+c+v).text(v+1).attr("data-date",d+"/"+(r+1)+"/"+(v+1)).addClass("other")}if(n.data&&t.loadData(a),n.date){var _=n.date;e.find("td[data-date='"+_.getFullYear()+"/"+(_.getMonth()+1)+"/"+_.getDate()+"']").addClass("active")}},loadData:function(a){var t=$(a),e=t.data("calendar").options,n=e.data,l=t.find("td");l.css({background:"transparent"}),l.prop("class","").removeAttr("data-type").removeAttr("data-blackbox").children().remove();for(var d=0;d<l.length;d++){var r=l.eq(d).attr("data-date");if(r)for(var o=r.split("/")[0],i=r.split("/")[1],s=r.split("/")[2],c=0;c<n.length;c++){var v=n[c].date;if(v.getFullYear()==o&&v.getMonth()+1==i&&v.getDate()==s){"normal"==n[c].type?l.eq(d).addClass("lava-calendar-normal").attr("data-type","normal").css({background:e.normalColor}):"alarm"==n[c].type&&l.eq(d).addClass("lava-calendar-alarm").attr("data-type","alarm").css({background:e.alarmColor}),n[c].blackbox&&l.eq(d).append("<div class='lava-calendar-blackbox'></div>").attr("data-blackbox",!0),n[c].device&&l.eq(d).append("<div class='lava-calendar-device'></div>"),n[c].server&&l.eq(d).append("<div class='lava-calendar-server'></div>");break}}}},gotoMonth:function(a,t){var e=this,n=$(a),l=n.data("calendar").options,d=l.currentDate.getMonth();if(l.currentDate.setMonth("next"==t?d+1:d-1),e.loadDate(a),l.onMonthChange){var r=l.currentDate,o=new Date(r.getFullYear()+"/"+e.round(r.getMonth()+1)+"/"+e.round(r.getDate())+" 00:00:00"),i=new Date(o.getTime());i.setMonth(i.getMonth()+1),i.setTime(i.getTime()-1),l.onMonthChange(o,i)}},resize:function(a){var t=$(a),e=.6*t.width()/6;t.find("td").css({height:e})},round:function(a){return 10>a?"0"+a:a},bindEvent:function(a){var t=this,e=$(a),n=e.data("calendar").options;e.on("selectstart",function(){return!1}),e.find(".lava-calendar-prev").on("click",function(){t.gotoMonth(a,"prev")}),e.find(".lava-calendar-next").on("click",function(){t.gotoMonth(a,"next")}),e.find("td").on("click dblclick",function(l){e.find("td").children(".lava-calendar-active").remove();var d=$(this),r=d.width()+2,o=d.height()+2;if(d.append("<div class='lava-calendar-active' style='width:"+r+"px;height:"+o+"px;'></div>"),"click"==l.type&&n.onClick&&d.attr("data-date")){var i={date:new Date(d.attr("data-date")),type:d.attr("data-type"),blackbox:d.attr("data-blackbox")};n.date=i.date,n.onClick(i)}if("dblclick"==l.type&&n.onDblclick&&d.attr("data-date")){var i={date:new Date(d.attr("data-date")),type:d.attr("data-type"),blackbox:d.attr("data-blackbox")};n.date=i.date,n.onDblclick(i)}d.hasClass("active")||(e.find(".active").removeClass("active"),d.addClass("active")),d.hasClass("other")&&(n.currentDate=new Date(d.attr("data-date")),t.loadDate(a))})},select:function(a,t){var e=this,n=$(a),l=n.data("calendar").options;l.date=t,l.currentDate=new Date(t.getFullYear()+"/"+(t.getMonth()+1)+"/1"),e.loadDate(a),n.find(".active").removeClass("active");var d=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),r=n.find("td[data-date='"+d+"']");r.addClass("active")}};$.fn.lavaCalendar=function(a,t){return"string"==typeof a?$.fn.lavaCalendar.methods[a](this,t):void $.each(this,function(){var t={};$(this).data("calendar"),$.extend(t,$.fn.lavaCalendar.defaults),$(this).data("calendar",{options:t}),$.extend($(this).data("calendar").options,a),lavaCalendar.init(this),lavaCalendar.bindEvent(this),a.data&&lavaCalendar.loadData(this)})},$.fn.lavaCalendar.defaults={lang:"zh-CN",alarmColor:"#e26a6a",normalColor:"#26c281",currentDate:new Date,showOtherDate:!1,onClick:null,onDblclick:null,onMonthChange:null},$.fn.lavaCalendar.methods={loadData:function(a,t){$(a).data("calendar").options.data=t,lavaCalendar.loadData(a)},getDate:function(a){return $(a).data("calendar").options.currentDate},getSelected:function(a){return $(a).data("calendar").options.date},select:function(a,t){lavaCalendar.select(a,t)},unselect:function(a){var t=$(a);t.data("calendar").options.date=null,t.find(".active").removeClass("active")}},$.fn.lavaCalendar.locales={"zh-CN":["日","一","二","三","四","五","六"],"zh-TW":["日","一","二","三","四","五","六"],ar:"ح_ن_ث_ر_خ_ج_س".split("_"),bo:"ཉི་མ་_ཟླ་བ་_མིག་དམར་_ལྷག་པ་_ཕུར་བུ_པ་སངས་_སྤེན་པ་".split("_"),de:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),"en-gb":"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),"en-US":"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),fr:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),it:"D_L_Ma_Me_G_V_S".split("_"),ja:"日_月_火_水_木_金_土".split("_"),ru:"вс_пн_вт_ср_чт_пт_сб".split("_"),"pt-PT":"7_1_2_3_4_5_6".split("_"),fa:"S_M_T_W_T_F_S".split("_")};