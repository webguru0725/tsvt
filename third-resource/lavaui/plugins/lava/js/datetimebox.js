!function(a){var c={init:function(a){var c=this;c.initDom(a)},initDom:function(c){var h=this,v=a(c),g=v.data("datetimebox").options;v.combo(g);var b=v.combo("panel"),C=a("<div class='datetimebox-container'></div>").appendTo(b),w={showOtherDate:!0,onClick:function(){var a=v.val();h.formatDate(v,C,v.data("datetimebox").timespinner,g),g.onChange&&g.onChange(a,v.val())},lang:g.lang?g.lang:"zh-CN",onLoadDateSuccess:g.onLoadDateSuccess,onMonthChange:g.onMonthChange};if(C.lavaCalendar(w),v.data("datetimebox").calendar=C,g.showTime){var D=a("<div class='form-group' style='margin:5px;'></div>").appendTo(b),y=a("<input type='text' class='form-control' />").appendTo(D),M={showSeconds:/ss/.test(g.format),onChange:function(){var a=v.val();h.formatDate(v,C,y,g),g.onChange&&g.onChange(a,v.val())}};y.timespinner(M),v.data("datetimebox").timespinner=y}g.showIcon&&v.after("<span class='datetimebox-icon'></span>"),h.initEvent(v,C,v.data("datetimebox").timespinner,g)},initEvent:function(a,c,h,v){var g=this;a.on("blur",function(){var b=a.val();if(""!=b){h&&b.split("")[1]&&h.timespinner("setValue",b.split(" ")[1]);var C=b.split(" ")[0].replace(/-/g,"/");if(isNaN(new Date(C).getFullYear()))var w=new Date;else var w=new Date(C);c.lavaCalendar("select",w),g.formatDate(a,c,h,v)}}),v.showIcon&&a.next(".datetimebox-icon").on("click",function(e){a.click(),e.stopPropagation()})},formatDate:function(a,c,h,v){var g=this,b=c.lavaCalendar("getSelected");b||(b=new Date,c.lavaCalendar("select",b));var C=b.getFullYear(),w=g.round(b.getMonth()+1),D=g.round(b.getDate()),y=v.format.split(" ")[0].replace("yyyy",C).replace("MM",w).replace("dd",D);if(h&&!h.val()){var M=new Date,S=v.format.split(" ")[1].replace("hh",g.round(M.getHours())).replace("mm",g.round(M.getMinutes())).replace("ss",g.round(M.getSeconds()));h.val(S)}y=h?y+" "+h.val():y,a.val(y)},round:function(a){return 10>a?"0"+a:a},setValue:function(c,h){var v=this,g=a(c),b=g.data("datetimebox"),C=b.calendar,w=b.timespinner,D=b.options;return""==h?(C.lavaCalendar("unselect"),w&&w.val(""),void g.val("")):(w&&h.split("")[1]&&w.timespinner("setValue",h.split(" ")[1]),C.lavaCalendar("select",new Date(h.split(" ")[0].replace(/-/g,"/"))),void v.formatDate(g,C,w,D))}};a.fn.datetimebox=function(h,v){return"string"==typeof h?a.fn.datetimebox.methods[h](this,v):void a.each(this,function(){var v={};a.extend(v,a.fn.combo.defaults),a.extend(v,a.fn.lavaCalendar.defaults),a.extend(v,a.fn.datetimebox.defaults),v.showTime&&a.extend(v,a.fn.timespinner.defaults),a.extend(v,h),a(this).data("datetimebox",{options:v}),a.extend(a.fn.lavaCalendar.locales,a(this).data("datetimebox").options.weekMonth),c.init(this)})},a.fn.datetimebox.defaults={format:"yyyy-MM-dd hh:mm:ss",showTime:!0,showIcon:!1,panelWidth:250,panelHeight:"auto",showArrow:!1,onLoadDateSuccess:null,onMonthChange:null,onChange:null,weekMonth:{}},a.fn.datetimebox.methods={setValue:function(a,h){c.setValue(a,h)}}}(jQuery);