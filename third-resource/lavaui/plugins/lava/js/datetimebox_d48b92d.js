!function(e){var a={init:function(e){var a=this;a.initDom(e)},initDom:function(a){var t=this,n=e(a),o=n.data("datetimebox").options;n.combo(o);var i=n.combo("panel"),l=e("<div class='datetimebox-container'></div>").appendTo(i),s={showOtherDate:!0,onClick:function(){var e=n.val();t.formatDate(n,l,n.data("datetimebox").timespinner,o),o.onChange&&o.onChange(e,n.val())},lang:o.lang?o.lang:"zh-CN",onLoadDateSuccess:o.onLoadDateSuccess,onMonthChange:o.onMonthChange};if(l.lavaCalendar(s),n.data("datetimebox").calendar=l,o.showTime){var r=e("<div class='form-group' style='margin:5px;'></div>").appendTo(i),d=e("<input type='text' class='form-control' />").appendTo(r),c={showSeconds:/ss/.test(o.format),onChange:function(){var e=n.val();t.formatDate(n,l,d,o),o.onChange&&o.onChange(e,n.val())}};d.timespinner(c),n.data("datetimebox").timespinner=d}o.showIcon&&n.after("<span class='datetimebox-icon'></span>"),t.initEvent(n,l,n.data("datetimebox").timespinner,o)},initEvent:function(e,a,t,n){var o=this;e.on("blur",function(){var i=e.val();if(""!=i){t&&i.split("")[1]&&t.timespinner("setValue",i.split(" ")[1]);var l=i.split(" ")[0].replace(/-/g,"/");if(isNaN(new Date(l).getFullYear()))var s=new Date;else var s=new Date(l);a.lavaCalendar("select",s),o.formatDate(e,a,t,n)}}),n.showIcon&&e.next(".datetimebox-icon").on("click",function(a){e.click(),a.stopPropagation()})},formatDate:function(e,a,t,n){var o=this,i=a.lavaCalendar("getSelected");i||(i=new Date,a.lavaCalendar("select",i));var l=i.getFullYear(),s=o.round(i.getMonth()+1),r=o.round(i.getDate()),d=n.format.split(" ")[0].replace("yyyy",l).replace("MM",s).replace("dd",r);if(t&&!t.val()){var c=new Date,m=n.format.split(" ")[1].replace("hh",o.round(c.getHours())).replace("mm",o.round(c.getMinutes())).replace("ss",o.round(c.getSeconds()));t.val(m)}d=t?d+" "+t.val():d,e.val(d)},round:function(e){return 10>e?"0"+e:e},setValue:function(a,t){var n=this,o=e(a),i=o.data("datetimebox"),l=i.calendar,s=i.timespinner,r=i.options;return""==t?(l.lavaCalendar("unselect"),s&&s.val(""),void o.val("")):(s&&t.split("")[1]&&s.timespinner("setValue",t.split(" ")[1]),l.lavaCalendar("select",new Date(t.split(" ")[0].replace(/-/g,"/"))),void n.formatDate(o,l,s,r))}};e.fn.datetimebox=function(t,n){return"string"==typeof t?e.fn.datetimebox.methods[t](this,n):void e.each(this,function(){var n={};e.extend(n,e.fn.combo.defaults),e.extend(n,e.fn.lavaCalendar.defaults),e.extend(n,e.fn.datetimebox.defaults),n.showTime&&e.extend(n,e.fn.timespinner.defaults),e.extend(n,t),e(this).data("datetimebox",{options:n}),e.extend(e.fn.lavaCalendar.locales,e(this).data("datetimebox").options.weekMonth),a.init(this)})},e.fn.datetimebox.defaults={format:"yyyy-MM-dd hh:mm:ss",showTime:!0,showIcon:!1,panelWidth:250,panelHeight:"auto",showArrow:!1,onLoadDateSuccess:null,onMonthChange:null,onChange:null,weekMonth:{}},e.fn.datetimebox.methods={setValue:function(e,t){a.setValue(e,t)}}}(jQuery);