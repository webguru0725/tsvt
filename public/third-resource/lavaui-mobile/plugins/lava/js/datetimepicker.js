var datetimepicker={bigMonth:[1,3,5,7,8,10,12],smallMonth:[2,4,6,9,11],init:function(e){var t=this;$(e),t.initDom(e),t.bindEvent(e)},initDom:function(e){for(var t=$(e),i=t.data("datetimepicker").options,a=[],d=parseInt(i.startYear),r=parseInt(i.endYear),s=0;r-d+1>s;s++)a.push(d+s);for(var l=datetimepicker.generatePickItem(a),n=[],s=0;12>s;s++)n.push(s+1);for(var c=datetimepicker.generatePickItem(n),m=[],s=0;31>s;s++)m.push(s+1);for(var o=datetimepicker.generatePickItem(m),p=[],s=0;24>s;s++)p.push(s);for(var v=datetimepicker.generatePickItem(p),h=[],s=0;61>s;s++)h.push(s);for(var u=datetimepicker.generatePickItem(h),f=[],s=0;61>s;s++)f.push(s);var k=datetimepicker.generatePickItem(f),g=(new Date).getTime()+parseInt(10*Math.random()),y='<div id="'+g+'" class="datetime-container"><div class="datetime-header">'+i.header+'</div><div class="datetime-body"><div class="datetime-item-col"><div class="datetime-item-col-wrapper year">'+l.join("")+'</div></div><div class="datetime-item-col"><div class="datetime-item-col-wrapper month">'+c.join("")+'</div></div><div class="datetime-item-col"><div class="datetime-item-col-wrapper day">'+o.join("")+"</div></div>";i.showTime&&(y=y+'<div class="datetime-item-col-divider"></div><div class="datetime-item-col"><div class="datetime-item-col-wrapper hour">'+v.join("")+'</div></div><div class="datetime-item-col-divider">:</div><div class="datetime-item-col"><div class="datetime-item-col-wrapper minute">'+u.join("")+'</div></div><div class="datetime-item-col-divider">:</div><div class="datetime-item-col"><div class="datetime-item-col-wrapper second">'+k.join("")+"</div></div>"),y+='<div class="datetime-item-highlight"></div></div></div>',i.container=$(y).appendTo("body"),window.setTimeout(function(){i.container.find(".datetime-item-col").scrollTop(72)},10)},generatePickItem:function(e){var t='<div class="datetime-item {selected}" data-item-value="{value}">{value}</div>',i=[];if(0===e.length)return[];i.push(t.replace(/{value}/g,"").replace("{selected}","")),i.push(t.replace(/{value}/g,"").replace("{selected}",""));for(var a=0;a<e.length;a++){var d=t.replace(/{value}/g,e[a]<10?"0"+e[a]:e[a]);d=2===a?d.replace("{selected}","datetime-selected"):d.replace("{selected}",""),i.push(d)}return i.push(t.replace(/{value}/g,"").replace("{selected}","")),i.push(t.replace(/{value}/g,"").replace("{selected}","")),i},bindEvent:function(e){var t=$(e),i=t.data("datetimepicker").options;t.on("click",function(){i.container.is(":visible")||i.container.css("display","block")}),$(".datetime-item-col").on("scroll",function(t){i.timer&&(i.isScrolling=!1,window.clearTimeout(i.timer)),i.timer=window.setTimeout(function(){if(!i.isScrolling){var a=$(t.target);a.hasClass("datetime-item-col")||(a=a.parent().hasClass("datetime-item-col")?a.parent():a.parent().parent());var d=a.scrollTop(),r=a.children(".datetime-item-col-wrapper"),s=Math.round(d/36);if((s===r.children(".datetime-item").length-3||s===r.children(".datetime-item").length-2)&&(s=r.children(".datetime-item").length-4),0!==d&&d%36!==0)return d=36*s,void a.animate({scrollTop:d},"","",function(){r.children(".datetime-item.datetime-selected").removeClass("datetime-selected"),r.children(".datetime-item").eq(s+2).addClass("datetime-selected"),datetimepicker.changeDayToMaxDay(e)});r.children(".datetime-item.datetime-selected").removeClass("datetime-selected"),r.children(".datetime-item").eq(s+2).addClass("datetime-selected"),datetimepicker.changeDayToMaxDay(e),i.isScrolling=!0}},300)})},changeDayToMaxDay:function(e){var t=$(e).data("datetimepicker").options.container,i=t.find(".year").children(".datetime-selected").attr("data-item-value"),a=new Date;a.setYear(parseInt(i));var d=parseInt(t.find(".month").find(".datetime-selected").attr("data-item-value")),r=parseInt(t.find(".day").find(".datetime-selected").attr("data-item-value"));a.setMonth(d),a.setDate(1);var s=new Date(a.getTime()-864e5).getDate();r>s&&(t.find(".day").children(".datetime-selected").removeClass("datetime-selected"),t.find(".day").children(".datetime-item[data-item-value='"+s+"']").addClass("datetime-selected"),t.find(".day").parent().scrollTop(36*(s-1)))},setValue:function(e,t,i){var a=$(e).data("datetimepicker").options.container;a.find("."+t).parent().scrollTop(36*i),a.find("."+t).children(".datetime-selected").removeClass("datetime-selected"),a.find("."+t).children(".datetime-item").eq(i+2).addClass("datetime-selected")}};$.fn.datetimepicker=function(e,t){if("string"==typeof e)return $.fn.datetimepicker.methods[e](this,t);var i={};$(this).data("datetimepicker")&&$(this).data("datetimepicker").options&&(i=$(this).data("datetimepicker").options),"{}"===JSON.stringify(i)&&$.extend(i,$.fn.datetimepicker.defaults),$.extend(i,e),$(this).data("datetimepicker",{options:i}),datetimepicker.init(this)},$.fn.datetimepicker.defaults={startYear:1937,endYear:(new Date).getFullYear(),showTime:!0,header:"",timer:0,isScrolling:!1},$.fn.datetimepicker.methods={show:function(e){var t=$(e).data("datetimepicker").options;t.container.show()},hide:function(e){var t=$(e).data("datetimepicker").options;t.container.hide()},getValue:function(e,t){var i=$(e).data("datetimepicker").options,a=i.container,d=a.find(".year").children(".datetime-selected").attr("data-item-value"),r=a.find(".month").children(".datetime-selected").attr("data-item-value"),s=a.find(".day").children(".datetime-selected").attr("data-item-value");if(i.showTime)var l=a.find(".hour").children(".datetime-selected").attr("data-item-value"),n=a.find(".minute").children(".datetime-selected").attr("data-item-value"),c=a.find(".second").children(".datetime-selected").attr("data-item-value");return t?i.showTime?t.replace("yyyy",d).replace("MM",r).replace("dd",s).replace("hh",l).replace("mm",n).replace("ss",c):t.replace("yyyy",d).replace("MM",r).replace("dd",s):i.showTime?d+"-"+r+"-"+s+" "+l+":"+n+":"+c:d+"-"+r+"-"+s},setValue:function(e,t){var i=$(e).data("datetimepicker").options,a=i.container,d=t.split(" ")[0].split("-")[0],r=t.split(" ")[0].split("-")[1],s=t.split(" ")[0].split("-")[2],l=i.startYear,n=i.endYear;if(parseInt(d)>n)return void console.error("年份大于最大年份");parseInt(r)>12&&(r%=12),parseInt(s)>31&&(s%=31);var c=parseInt(d)-l;if(a.find(".year").children(".datetime-selected").removeClass("datetime-selected"),a.find(".year").children(".datetime-item[data-item-value='"+d+"']").addClass("datetime-selected"),a.find(".month").children(".datetime-selected").removeClass("datetime-selected"),a.find(".month").children(".datetime-item[data-item-value='"+r+"']").addClass("datetime-selected"),a.find(".day").children(".datetime-selected").removeClass("datetime-selected"),a.find(".day").children(".datetime-item[data-item-value='"+s+"']").addClass("datetime-selected"),datetimepicker.setValue(e,"year",c),c=parseInt(r-1),datetimepicker.setValue(e,"month",c),c=parseInt(s-1),datetimepicker.setValue(e,"day",c),window.setTimeout(function(){datetimepicker.changeDayToMaxDay(e)},1e3),i.showTime&&t.split(" ")[1]){var m=t.split(" ")[1].split(":")[0],o=t.split(" ")[1].split(":")[1],p=t.split(" ")[1].split(":")[2];a.find(".hour").children(".datetime-selected").removeClass("datetime-selected"),a.find(".hour").children(".datetime-item[data-item-value='"+m+"']").addClass("datetime-selected"),a.find(".second").children(".datetime-selected").removeClass("datetime-selected"),a.find(".second").children(".datetime-item[data-item-value='"+p+"']").addClass("datetime-selected"),a.find(".minute").children(".datetime-selected").removeClass("datetime-selected"),a.find(".minute").children(".datetime-item[data-item-value='"+o+"']").addClass("datetime-selected"),parseInt(m)>23&&(m%=23),parseInt(o)>60&&(o%=60),parseInt(p)>60&&(p%=60),c=parseInt(m),datetimepicker.setValue(e,"hour",c),c=parseInt(o),datetimepicker.setValue(e,"minute",c),c=parseInt(p),datetimepicker.setValue(e,"second",c)}}};