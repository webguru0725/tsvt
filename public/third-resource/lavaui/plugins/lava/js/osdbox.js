var osdbox={init:function(a){var h=$(a),c=h.data("osdbox").options;h.hasClass("osdbox")?h.html(""):h.addClass("osdbox");var g=$("<div class='osd-container'></div>").appendTo(h);c.container=g,g.css({width:c.width,height:c.height,position:"relative"}),g.css(c.backgroundImg?{"background-image":url(c.backgroundImg)}:{"background-color":c.backgroundColor}),osdbox.loadData(h,c.data),osdbox.bindEvent(h)},isIE:function(){return navigator.userAgent.toUpperCase().indexOf("TRIEDENT")>=0?!0:!1},loadData:function(a,h){var c=a.data("osdbox").options;c.data=h;var g=c.borderColor,b=c.container,v=c.resolutionRatio.split("*")[0],w=c.resolutionRatio.split("*")[1],I=c.width,y=c.height;b.html("");for(var C="<div class='osd-item' data-index = {index} style='position:absolute;left:{x};top:{y};border:1px solid {borderColor};width:{width};height:{height}'><span>{text}</span></div>",D=[],i=0;i<h.length;i++){var x=parseInt(h[i].x*I/v);h[i].x_real=x;var k=parseInt(h[i].y*y/w);h[i].y_real=k;var E=h[i].text,_=C.replace("{index}",i).replace("{borderColor}",g).replace("{x}",x+"px").replace("{y}",k+"px").replace("{text}",E);_=h[i].width?_.replace("{width}",h[i].width):_.replace("{width}","auto"),_=h[i].height?_.replace("{height}",h[i].height):_.replace("{height}","auto"),D.push(_)}b.html(D.join("")),b.find(".osd-item").each(function(a,h){osdbox.isIE?$(h).css("width",$(h).children().width()+2):$(h).css("width",$(h).children().width()),$(h).offset().left+$(h).width()>=b.offset().left+c.width&&$(h).offset({left:b.offset().left+c.width-$(h).width()-2}),osdbox.isIE?$(h).css("height",$(h).children().height()+2):$(h).css("height",$(h).children().height()),$(h).offset().top+$(h).height()>=b.offset().top+c.height&&$(h).offset({top:b.offset().top+c.height-$(h).height()-2})})},getData:function(a){for(var h=$(a),c=h.data("osdbox").options,g=c.data,b=c.resolutionRatio,v=c.container,w=b.split("*")[0],I=b.split("*")[1],y=v.width(),C=v.height(),i=0;i<g.length;i++){var x=g[i].x_real,D=g[i].y_real;g[i].x=parseInt(w*x/y),g[i].y=parseInt(I*D/C)}return g},bindEvent:function(a){var h,c,g,b,v,w=a.data("osdbox").options,I=w.container,y=!1;I.delegate(".osd-item","mousedown",function(e){var a=$(e.target);a.hasClass("osd-item")||(a=a.parent()),v=a,h=parseInt(a.css("left")),c=parseInt(a.css("top")),g=e.clientX,b=e.clientY,y=!0}).on("mousemove mouseup",function(e){var $=v;w=a.data("osdbox").options;var I=w.data;if(y){clientX=e.clientX,clientY=e.clientY;var C=clientX-g,D=clientY-b;g=clientX,b=clientY,h+=C,1>=h&&(h=1),h>=$.parent().width()-$.width()-3&&(h=$.parent().width()-$.width()-3),c+=D,1>=c&&(c=1),c>=$.parent().height()-$.height()-3&&(c=$.parent().height()-$.height()-3),$.css("left",h+"px"),$.css("top",c+"px"),I[$.attr("data-index")].x_real=h,I[$.attr("data-index")].y_real=c}"mouseup"===e.type&&(h=0,c=0,g=0,b=0,y=!1)}),$("body").on("mouseup",function(){h=0,c=0,g=0,b=0,y=!1})}};$.fn.osdbox=function(a,h){return"string"==typeof a?$.fn.osdbox.methods[a](this,h):void $.each(this,function(){var h={};$.extend(h,$.fn.osdbox.default),$.extend(h,a),$(this).data("osdbox",{options:h}),osdbox.init(this)})},$.fn.osdbox.default={width:100,height:100,backgroundColor:"#27313a",backgroundImg:"",borderColor:"#f00",data:[],resolutionRatio:"1024*768"},$.fn.osdbox.methods={getData:function(a){var h=osdbox.getData(a);return h||[]},setData:function(a,h){var c=$(a);osdbox.loadData(c,h)}};