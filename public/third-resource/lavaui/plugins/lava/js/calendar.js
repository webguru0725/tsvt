var lavaCalendar={init:function(a){var c=this,v=$(a),h=v.data("calendar").options,g=$.fn.lavaCalendar.locales[h.lang];v.hasClass("lava-calendar")?v.html(""):v.addClass("lava-calendar");for(var _=$("<div class='lava-calendar-header' style='background:"+h.color+";'></div>").appendTo(v),D=($("<div class='lava-calendar-prevyear'>«</div>").appendTo(_),$("<div class='lava-calendar-nextyear'>»</div>").appendTo(_),$("<div class='lava-calendar-prevmonth'><</div>").appendTo(_),$("<div class='lava-calendar-nextmonth'>></div>").appendTo(_),$("<span class='lava-calendar-text'></span>").appendTo(_),$("<table class='lava-calendar-table'></table>").appendTo(v)),b=$("<thead class='lava-calendar-thead'></thead>").appendTo(D),y=$("<tbody class='lava-calendar-tbody'></tbody>").appendTo(D),C=["<tr>"],i=0;7>i;i++)C.push("<th style='color:"+h.color+";'>"+g[i]+"</th>");C.push("</tr>");for(var M=[],i=0;6>i;i++){for(var k=["<tr>"],T=0;7>T;T++)k.push("<td></td>");k.push("</tr>"),M.push(k.join(""))}b.html(C.join("")),y.html(M.join(""));for(var w=$("<div class='lava-calendar-menu hidden'></div>").appendTo(v),Y=$("<div class='lava-calendar-menu-year'></div>").appendTo(w),S=($("<div class='lava-calendar-prevyear-inner'>«</div>").appendTo(Y),$("<span><input class='lava-calendar-menu-year-input'/></span>").appendTo(Y),$("<div class='lava-calendar-nextyear-inner'>»</div>").appendTo(Y),$("<div class='lava-calendar-menu-month'></div>").appendTo(w)),F=$("<table></table>").appendTo(S),O=$("<tbody></tbody>").appendTo(F),A=[],i=1;13>i;i++){var J="";(0===i||i%4===1)&&(J+="<tr>"),J=J+"<td data-month='"+i+"'>"+g[i+6]+"</td>",0!==i&&i%4===0&&(J+="</tr>"),A.push(J)}$(A.join("")).appendTo(O),c.loadDate(a),c.resize(a)},loadDate:function(a){var c=this,v=$(a),h=v.data("calendar").options,g=h.currentDate;g.setDate(1);var _=h.currentDate.getFullYear(),D=h.currentDate.getMonth();v.find(".lava-calendar-header span").text(_+"-"+c.round(D+1));var b=v.find(".lava-calendar-table").find("td"),y=g.getDay(),C=new Date(g.getTime());C.setMonth(D+1),C.setTime(C.getTime()-864e5);var M=C.getDate();b.text("").removeAttr("data-date").removeAttr("class");for(var i=0;M>i;i++)b.eq(i+y).text(i+1).attr("data-date",_+"/"+(D+1)+"/"+(i+1));if(h.showOtherDate){for(var k=new Date(g.getTime()-864e5),T=k.getDate(),_=k.getFullYear(),D=k.getMonth(),i=0;y>i;i++){var w=T-y+i+1;b.eq(i).text(w).attr("data-date",_+"/"+(D+1)+"/"+w).addClass("other")}var Y=new Date(g.getTime());Y.setMonth(D+2);for(var _=Y.getFullYear(),D=Y.getMonth(),i=0;42-y-M>i;i++)b.eq(y+M+i).text(i+1).attr("data-date",_+"/"+(D+1)+"/"+(i+1)).addClass("other")}if(h.data&&c.loadData(a),h.date){var w=h.date;v.find(".lava-calendar-table").find("td[data-date='"+w.getFullYear()+"/"+(w.getMonth()+1)+"/"+w.getDate()+"']").addClass("active")}h.onLoadDateSuccess&&h.onLoadDateSuccess()},loadData:function(a){var c=$(a),v=c.data("calendar").options,h=v.data,g=c.children("table").find("td");g.css({background:"transparent"}),g.prop("class","").removeAttr("data-type").removeAttr("data-blackbox").children().remove();for(var i=0;i<g.length;i++){var _=g.eq(i).attr("data-date");if(_)for(var D=_.split("/")[0],b=_.split("/")[1],y=_.split("/")[2],C=0;C<h.length;C++){var M=h[C].date;if(M.getFullYear()==D&&M.getMonth()+1==b&&M.getDate()==y){"normal"==h[C].type?g.eq(i).addClass("lava-calendar-normal").attr("data-type","normal").css({background:v.normalColor}):"alarm"==h[C].type?g.eq(i).addClass("lava-calendar-alarm").attr("data-type","alarm").css({background:v.alarmColor}):"warn"==h[C].type&&g.eq(i).addClass("lava-calendar-alarm").attr("data-type","warn").css({background:v.warnColor}),h[C].blackbox&&g.eq(i).append("<div class='lava-calendar-blackbox'></div>").attr("data-blackbox",!0),h[C].device&&g.eq(i).append("<div class='lava-calendar-device'></div>"),h[C].server&&g.eq(i).append("<div class='lava-calendar-server'></div>");break}}}},gotoMonthOrYear:function(a,c,v){var h=this,g=$(a),_=g.data("calendar").options;if("month"===c){var D=_.currentDate.getMonth();_.currentDate.setMonth("next"==v?D+1:D-1)}else if("year"===c){var b=_.currentDate.getFullYear();_.currentDate.setYear("next"==v?b+1:b-1)}else if("monthyear"===c){var b=v.split("-")[0],D=v.split("-")[1];_.currentDate.setYear(parseInt(b)),_.currentDate.setMonth(parseInt(D)-1)}if(h.loadDate(a),_.onMonthChange){var y=_.currentDate,C=new Date(y.getFullYear()+"/"+h.round(y.getMonth()+1)+"/"+h.round(y.getDate())+" 00:00:00"),M=new Date(C.getTime());M.setMonth(M.getMonth()+1),M.setTime(M.getTime()-1),_.onMonthChange(C,M)}},resize:function(a){var c=$(a),v=.6*c.width()/6;c.find(".lava-calendar-table").find("td").css({height:v})},round:function(a){return 10>a?"0"+a:a},bindEvent:function(a){var c=this,v=$(a),h=v.data("calendar").options;v.on("selectstart",function(){return!1}),v.find(".lava-calendar-prevyear").on("click",function(){c.gotoMonthOrYear(a,"year","prev")}),v.find(".lava-calendar-nextyear").on("click",function(){c.gotoMonthOrYear(a,"year","next")}),v.find(".lava-calendar-prevyear-inner").on("click",function(){v.find(".lava-calendar-menu-year-input").val(parseInt(v.find(".lava-calendar-menu-year-input").val())-1)}),v.find(".lava-calendar-nextyear-inner").on("click",function(){v.find(".lava-calendar-menu-year-input").val(parseInt(v.find(".lava-calendar-menu-year-input").val())+1)}),v.find(".lava-calendar-prevmonth").on("click",function(){c.gotoMonthOrYear(a,"month","prev")}),v.find(".lava-calendar-nextmonth").on("click",function(){c.gotoMonthOrYear(a,"month","next")}),v.children("table").find("td").on("click dblclick",function(e){v.find("td").children(".lava-calendar-active").remove();var g=$(this),_=g.width()+2,D=g.height()+2;if(g.append("<div class='lava-calendar-active' style='width:"+_+"px;height:"+D+"px;'></div>"),"click"==e.type&&h.onClick&&g.attr("data-date")){var b={date:new Date(g.attr("data-date")),type:g.attr("data-type"),blackbox:g.attr("data-blackbox")};h.date=b.date,h.onClick(b)}if("dblclick"==e.type&&h.onDblclick&&g.attr("data-date")){var b={date:new Date(g.attr("data-date")),type:g.attr("data-type"),blackbox:g.attr("data-blackbox")};h.date=b.date,h.onDblclick(b)}g.hasClass("active")||(v.find(".active").removeClass("active"),g.addClass("active")),g.hasClass("other")&&(h.currentDate=new Date(g.attr("data-date")),c.loadDate(a))}),v.find(".lava-calendar-header span").on("mouseover mouseout click",function(e){var g=$(e.target);"mouseout"==e.type?$(e.target).removeClass("lava-calendar-nav-hover"):"mouseover"==e.type?g.hasClass("lava-calendar-nav-hover")||$(e.target).addClass("lava-calendar-nav-hover"):"click"==e.type&&(v.find(".lava-calendar-menu").is(":visible")?(v.find(".lava-calendar-menu").hide(),c.gotoMonthOrYear(a,"monthyear",v.find(".lava-calendar-text").text())):(v.find(".lava-calendar-menu-year-input").val(v.find(".lava-calendar-text").text().split("-")[0]),v.find(".lava-calendar-menu-month").find("td[data-month='"+(h.currentDate.getMonth()+1)+"']").click(),v.find(".lava-calendar-menu").show())),e.stopPropagation()}),v.find(".lava-calendar-menu-month").find("td").on("click",function(e){var h=$(e.target);v.find(".lava-calendar-selected-month").removeClass("lava-calendar-selected-month"),h.hasClass("lava-calendar-selected-month")||h.addClass("lava-calendar-selected-month"),v.find(".lava-calendar-text").text(v.find(".lava-calendar-menu-year-input").val()?parseInt(v.find(".lava-calendar-menu-year-input").val())+"-"+c.round(h.attr("data-month")):v.find(".lava-calendar-text").text().split("-")[0]+"-"+c.round(h.attr("data-month"))),c.gotoMonthOrYear(a,"monthyear",v.find(".lava-calendar-text").text()),v.find(".lava-calendar-menu").hide(),e.stopPropagation()})},select:function(a,c){var v=this,h=$(a),g=h.data("calendar").options;g.date=c,g.currentDate=new Date(c.getFullYear()+"/"+(c.getMonth()+1)+"/1"),v.loadDate(a),h.find(".active").removeClass("active");var _=c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate(),D=h.find("td[data-date='"+_+"']");D.addClass("active")}};$.fn.lavaCalendar=function(a,c){return"string"==typeof a?$.fn.lavaCalendar.methods[a](this,c):void $.each(this,function(){{var c={};$(this).data("calendar")}$.extend(c,$.fn.lavaCalendar.defaults),$(this).data("calendar",{options:c}),$.extend($(this).data("calendar").options,a),$.extend($.fn.lavaCalendar.locales,$(this).data("calendar").options.weekMonth),lavaCalendar.init(this),lavaCalendar.bindEvent(this),a.data&&lavaCalendar.loadData(this)})},$.fn.lavaCalendar.defaults={lang:"zh-CN",alarmColor:"#e26a6a",normalColor:"#26c281",warnColor:"#b1b323",currentDate:new Date,weekMonth:{},showOtherDate:!1,onClick:null,onDblclick:null,onMonthChange:null,onLoadDateSuccess:null},$.fn.lavaCalendar.methods={loadData:function(a,c){$(a).data("calendar").options.data=c,lavaCalendar.loadData(a)},getDate:function(a){return $(a).data("calendar").options.currentDate},getSelected:function(a){return $(a).data("calendar").options.date},select:function(a,c){lavaCalendar.select(a,c)},unselect:function(a){var c=$(a);c.data("calendar").options.date=null,c.find(".active").removeClass("active")}},$.fn.lavaCalendar.locales={"zh-CN":["日","一","二","三","四","五","六","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh-TW":["日","一","二","三","四","五","六","一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],ar:"ح_ن_ث_ر_خ_ج_س".split("_"),bo:"ཉི་མ་_ཟླ་བ་_མིག་དམར་_ལྷག་པ་_ཕུར་བུ_པ་སངས་_སྤེན་པ་".split("_"),de:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),"en-gb":["Su","Mo","Tu","We","Th","Fr","Sa","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"en-US":["Su","Mo","Tu","We","Th","Fr","Sa","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fr:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),it:"D_L_Ma_Me_G_V_S".split("_"),ja:"日_月_火_水_木_金_土".split("_"),ru:"вс_пн_вт_ср_чт_пт_сб".split("_"),"pt-PT":"7_1_2_3_4_5_6".split("_"),fa:"S_M_T_W_T_F_S".split("_")};